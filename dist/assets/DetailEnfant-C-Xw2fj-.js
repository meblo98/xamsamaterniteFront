import{L as V}from"./Layout-BJFKaUJJ.js";import{T as y}from"./tableau-BdoqOBfb.js";import{e as _}from"./enfantService-BrscLnQ2.js";import{c as r,_ as P}from"./_plugin-vue_export-helper-rQ_DBal5.js";import{S as s}from"./sweetalert2.all-BmwYcicJ.js";import{e as v,f as w,h as u,o as m,a as n,t as a,c as x,d as p,v as f,g as E}from"./index-1QRIi6KU.js";const d={async getVaccinations(){try{return(await r.get("/vaccinations")).data}catch{}},async getVaccination(t){try{return(await r.get(`/vaccinations/${t}`)).data}catch{}},async createVaccination(t){try{return(await r.post("/vaccinations",t)).data}catch{}},async updateVaccination(t,e){try{return(await r.put(`/vaccinations/${t}`,e)).data}catch{}},async deleteVaccination(t){try{return(await r.delete(`/vaccinations/${t}`)).data}catch{}},async getVaccinationByEnfant(t){try{return(await r.get(`/vaccinations/enfant/${t}`)).data}catch{}}},C={components:{Table:y,Layout:V},data(){return{enfant:{nom:"",prenom:"",date_de_naissance:"",lieu_de_naissance:"",sexe:""},maman:{nom:"",prenom:"",telephone:"",adresse:""},vaccinations:[],newVaccination:{nom:"",dose:"",observation:"",enfant_id:this.id},vaccinationColumns:[{label:"Nom du Vaccin",field:"nom"},{label:"Dose",field:"dose"},{label:"Observation",field:"observation"},{label:"Actions",field:"action",type:"action"}],vaccinationFields:[{name:"nom",label:"Nom du Vaccin",type:"text",placeholder:"Entrez le nom du vaccin"},{name:"dose",label:"Dose",type:"text",placeholder:"Entrez la dose"},{name:"observation",label:"Observation",type:"text",placeholder:"Entrez les observations"}],paginatedData:[],currentPage:1,totalItems:0,itemsPerPage:10}},props:{id:{type:Number,required:!0}},mounted(){this.fetchEnfantDetails(),this.getVaccination(),this.getVaccinationsPaginated()},methods:{async fetchEnfantDetails(){try{const t=await _.getEnfant(this.id);this.enfant=t,this.maman=t.accouchement.patiente.user}catch(t){console.error("Erreur lors de la récupération des détails de l'enfant :",t)}},async getVaccination(){try{const t=await d.getVaccinationByEnfant(this.id);t&&t.vaccinations&&Array.isArray(t.vaccinations)&&(this.vaccinations=t.vaccinations.map(e=>({id:e.id,nom:e.nom,dose:e.dose,observation:e.observation})),this.getVaccinationsPaginated())}catch(t){console.error("Erreur lors de la récupération des vaccinations :",t)}},handleTableAction({action:t,row:e}){t==="edit"?this.editVaccination(e):t==="delete"&&this.deleteVaccination(e.id)},async addVaccination(t=null){if(!t.nom||!t.dose||!t.observation){s.fire({icon:"error",title:"Erreur",text:"Tous les champs sont requis.",showConfirmButton:!1,timer:1500});return}t.enfant_id=this.id;try{await d.createVaccination(t),s.fire({title:"Vaccination ajoutée avec succès !",icon:"success",showConfirmButton:!1,timer:1500})}catch(e){console.error("Erreur lors de l'ajout de la vaccination :",e),s.fire({icon:"error",title:"Erreur",text:"Impossible d'ajouter la vaccination.",showConfirmButton:!1,timer:1500})}},async editVaccination(t){try{await d.updateVaccination(t.id,t),s.fire({title:"Vaccination modifiée avec succès !",icon:"success",showConfirmButton:!1,timer:1500})}catch(e){console.error("Erreur lors de la modification de la vaccination :",e)}},async deleteVaccination(t){s.fire({title:"Confirmation de suppression",text:"Êtes-vous sûr de vouloir supprimer cette vaccination ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Oui, supprimer",cancelButtonText:"Non, annuler"}).then(e=>{if(e.isConfirmed)try{d.deleteVaccination(t),this.getVaccination(),s.fire({title:"Suppression réussie",text:"La vaccination a été supprimée avec succès.",icon:"success"})}catch(l){console.error("Erreur lors de la suppression de la vaccination :",l),s.fire({title:"Erreur de suppression",text:"Une erreur est survenue lors de la suppression de la vaccination.",icon:"error"})}})},getVaccinationsPaginated(){const t=(this.currentPage-1)*this.itemsPerPage;this.paginatedData=this.vaccinations.slice(t,t+this.itemsPerPage)},handlePageChange(t){this.currentPage=t,this.getVaccinationsPaginated()}}},B={class:"container"},A={class:"row"},j={class:"col-md-5"},D={class:"project-info-box mt-0"},T={class:"col-md-7"},k={class:"project-info-box mt-0"},L={class:"mb-3"},N={class:"row"},I={class:"project-info-box mt-0"},S={key:0},z={class:"modal fade",id:"ajoutVaccination","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},q={class:"modal-dialog"},F={class:"modal-content"},O={class:"modal-body"},U={class:"form-group"},M={class:"form-group"},G={class:"form-group"},H={class:"modal-footer"};function J(t,e,l,K,o,c){const b=u("Table"),h=u("Pagination"),g=u("Layout");return m(),v(g,null,{default:w(()=>[n("div",B,[n("div",A,[n("div",j,[n("div",D,[e[4]||(e[4]=n("h5",null,"Informations sur l'enfant",-1)),n("p",null,"Prénom : "+a(o.enfant.prenom),1),n("p",null,"Nom : "+a(o.enfant.nom),1),n("p",null,"Date de naissance : "+a(o.enfant.date_naissance),1),n("p",null,"Lieu de naissance : "+a(o.enfant.lieu_naissance),1),n("p",null,"Sexe : "+a(o.enfant.sexe),1)])]),n("div",T,[n("div",k,[e[5]||(e[5]=n("h5",null,"Informations sur la maman",-1)),n("div",L,[n("p",null,"Nom : "+a(o.maman.nom),1),n("p",null,"Prénom : "+a(o.maman.prenom),1),n("p",null,"Téléphone : "+a(o.maman.telephone),1),n("p",null,"Adresse : "+a(o.maman.adresse),1)])])])]),n("div",N,[n("div",I,[o.vaccinations.length===0?(m(),x("div",S,[e[11]||(e[11]=n("button",{type:"button",class:"btn","data-bs-toggle":"modal","data-bs-target":"#ajoutVaccination"}," Ajouter une Vaccination ",-1)),n("div",z,[n("div",q,[n("div",F,[e[10]||(e[10]=n("div",{class:"modal-header"},[n("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Ajouter une Vaccination "),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),n("div",O,[n("div",U,[e[6]||(e[6]=n("label",{for:"nom"},"Nom du vaccin",-1)),p(n("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>o.newVaccination.nom=i),type:"text",class:"form-control",id:"nom",placeholder:"Entrez le nom du vaccin",required:""},null,512),[[f,o.newVaccination.nom]])]),n("div",M,[e[7]||(e[7]=n("label",{for:"dose"},"Dose",-1)),p(n("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>o.newVaccination.dose=i),type:"text",class:"form-control",id:"dose",placeholder:"Entrez la dose",required:""},null,512),[[f,o.newVaccination.dose]])]),n("div",G,[e[8]||(e[8]=n("label",{for:"observation"},"Observation",-1)),p(n("input",{"onUpdate:modelValue":e[2]||(e[2]=i=>o.newVaccination.observation=i),type:"text",class:"form-control",id:"observation",placeholder:"Entrez les observations",required:""},null,512),[[f,o.newVaccination.observation]])])]),n("div",H,[n("button",{class:"btn",onClick:e[3]||(e[3]=i=>c.addVaccination({...o.newVaccination}))}," Ajouter "),e[9]||(e[9]=n("button",{type:"button",class:"btn","data-bs-dismiss":"modal"}," Fermer ",-1))])])])]),e[12]||(e[12]=n("p",null,"Aucune vaccination trouvée.",-1))])):(m(),v(b,{key:1,columns:o.vaccinationColumns,data:o.paginatedData,title:"Liste des Vaccinations",formFields:o.vaccinationFields,onAction:c.handleTableAction,onAddData:c.addVaccination,onEditData:c.editVaccination},null,8,["columns","data","formFields","onAction","onAddData","onEditData"])),E(h,{currentPage:o.currentPage,totalItems:o.totalItems,itemsPerPage:o.itemsPerPage,onPageChanged:c.handlePageChange},null,8,["currentPage","totalItems","itemsPerPage","onPageChanged"])])])])]),_:1})}const $=P(C,[["render",J]]);export{$ as default};
