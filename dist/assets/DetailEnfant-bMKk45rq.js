import{L as y}from"./Layout-Ds3QvfcV.js";import{T as V}from"./tableau-nIdjVny8.js";import{e as w}from"./enfantService-DQKxlz4_.js";import{c,_}from"./_plugin-vue_export-helper-Cm6_9V8g.js";import{S as s}from"./sweetalert2.all-BXtj_mcp.js";import{e as v,f as P,h as u,o as m,a as t,t as a,c as E,d as p,v as f,g as x}from"./index-C-f7vtLL.js";const d={async getVaccinations(){try{return(await c.get("/vaccinations")).data}catch(n){throw console.error("Erreur lors de la récupération des vaccinations :",n),n}},async getVaccination(n){try{return(await c.get(`/vaccinations/${n}`)).data}catch(e){throw console.error(`Erreur lors de la récupération de la vaccination avec l'id ${n} :`,e),e}},async createVaccination(n){try{return(await c.post("/vaccinations",n)).data}catch(e){throw console.error("Erreur lors de la création de la vaccination :",e),e}},async updateVaccination(n,e){try{return(await c.put(`/vaccinations/${n}`,e)).data}catch(i){throw console.error(`Erreur lors de la mise à jour de la vaccination avec l'id ${n} :`,i),i}},async deleteVaccination(n){try{return(await c.delete(`/vaccinations/${n}`)).data}catch(e){throw console.error(`Erreur lors de la suppression de la vaccination avec l'id ${n} :`,e),e}},async getVaccinationByEnfant(n){try{return(await c.get(`/vaccinations/enfant/${n}`)).data}catch(e){throw console.error(`Erreur lors de la récupération de la vaccination avec l'id ${n} :`,e),e}}},C={components:{Table:V,Layout:y},data(){return{enfant:{nom:"",prenom:"",date_de_naissance:"",lieu_de_naissance:"",sexe:""},maman:{nom:"",prenom:"",telephone:"",adresse:""},vaccinations:[],newVaccination:{nom:"",dose:"",observation:"",enfant_id:this.id},vaccinationColumns:[{label:"Nom du Vaccin",field:"nom"},{label:"Dose",field:"dose"},{label:"Observation",field:"observation"},{label:"Actions",field:"action",type:"action"}],vaccinationFields:[{name:"nom",label:"Nom du Vaccin",type:"text",placeholder:"Entrez le nom du vaccin"},{name:"dose",label:"Dose",type:"text",placeholder:"Entrez la dose"},{name:"observation",label:"Observation",type:"text",placeholder:"Entrez les observations"}],paginatedData:[],currentPage:1,totalItems:0,itemsPerPage:10}},props:{id:{type:Number,required:!0}},mounted(){this.fetchEnfantDetails(),this.getVaccination(),this.getVaccinationsPaginated()},methods:{async fetchEnfantDetails(){try{const n=await w.getEnfant(this.id);this.enfant=n,this.maman=n.accouchement.patiente.user}catch(n){console.error("Erreur lors de la récupération des détails de l'enfant :",n)}},async getVaccination(){try{const n=await d.getVaccinationByEnfant(this.id);n&&n.vaccinations&&Array.isArray(n.vaccinations)&&(this.vaccinations=n.vaccinations.map(e=>({id:e.id,nom:e.nom,dose:e.dose,observation:e.observation})),this.getVaccinationsPaginated())}catch(n){console.error("Erreur lors de la récupération des vaccinations :",n)}},handleTableAction({action:n,row:e}){n==="edit"?this.editVaccination(e):n==="delete"&&this.deleteVaccination(e.id)},async addVaccination(n=null){if(!n.nom||!n.dose||!n.observation){s.fire({icon:"error",title:"Erreur",text:"Tous les champs sont requis.",showConfirmButton:!1,timer:1500});return}n.enfant_id=this.id;try{await d.createVaccination(n),s.fire({title:"Vaccination ajoutée avec succès !",icon:"success",showConfirmButton:!1,timer:1500})}catch(e){console.error("Erreur lors de l'ajout de la vaccination :",e),s.fire({icon:"error",title:"Erreur",text:"Impossible d'ajouter la vaccination.",showConfirmButton:!1,timer:1500})}},async editVaccination(n){try{await d.updateVaccination(n.id,n),s.fire({title:"Vaccination modifiée avec succès !",icon:"success",showConfirmButton:!1,timer:1500})}catch(e){console.error("Erreur lors de la modification de la vaccination :",e)}},async deleteVaccination(n){s.fire({title:"Confirmation de suppression",text:"Êtes-vous sûr de vouloir supprimer cette vaccination ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Oui, supprimer",cancelButtonText:"Non, annuler"}).then(e=>{if(e.isConfirmed)try{d.deleteVaccination(n),this.getVaccination(),s.fire({title:"Suppression réussie",text:"La vaccination a été supprimée avec succès.",icon:"success"})}catch(i){console.error("Erreur lors de la suppression de la vaccination :",i),s.fire({title:"Erreur de suppression",text:"Une erreur est survenue lors de la suppression de la vaccination.",icon:"error"})}})},getVaccinationsPaginated(){const n=(this.currentPage-1)*this.itemsPerPage;this.paginatedData=this.vaccinations.slice(n,n+this.itemsPerPage)},handlePageChange(n){this.currentPage=n,this.getVaccinationsPaginated()}}},B={class:"container"},A={class:"row"},j={class:"col-md-5"},D={class:"project-info-box mt-0"},T={class:"col-md-7"},k={class:"project-info-box mt-0"},L={class:"mb-3"},N={class:"row"},I={class:"project-info-box mt-0"},S={key:0},z={class:"modal fade",id:"ajoutVaccination","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},q={class:"modal-dialog"},F={class:"modal-content"},O={class:"modal-body"},U={class:"form-group"},M={class:"form-group"},G={class:"form-group"},H={class:"modal-footer"};function J(n,e,i,K,o,l){const h=u("Table"),b=u("Pagination"),g=u("Layout");return m(),v(g,null,{default:P(()=>[t("div",B,[t("div",A,[t("div",j,[t("div",D,[e[4]||(e[4]=t("h5",null,"Informations sur l'enfant",-1)),t("p",null,"Prénom : "+a(o.enfant.prenom),1),t("p",null,"Nom : "+a(o.enfant.nom),1),t("p",null,"Date de naissance : "+a(o.enfant.date_naissance),1),t("p",null,"Lieu de naissance : "+a(o.enfant.lieu_naissance),1),t("p",null,"Sexe : "+a(o.enfant.sexe),1)])]),t("div",T,[t("div",k,[e[5]||(e[5]=t("h5",null,"Informations sur la maman",-1)),t("div",L,[t("p",null,"Nom : "+a(o.maman.nom),1),t("p",null,"Prénom : "+a(o.maman.prenom),1),t("p",null,"Téléphone : "+a(o.maman.telephone),1),t("p",null,"Adresse : "+a(o.maman.adresse),1)])])])]),t("div",N,[t("div",I,[o.vaccinations.length===0?(m(),E("div",S,[e[11]||(e[11]=t("button",{type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#ajoutVaccination"}," Ajouter une Vaccination ",-1)),t("div",z,[t("div",q,[t("div",F,[e[10]||(e[10]=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Ajouter une Vaccination "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",O,[t("div",U,[e[6]||(e[6]=t("label",{for:"nom"},"Nom du vaccin",-1)),p(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>o.newVaccination.nom=r),type:"text",class:"form-control",id:"nom",placeholder:"Entrez le nom du vaccin",required:""},null,512),[[f,o.newVaccination.nom]])]),t("div",M,[e[7]||(e[7]=t("label",{for:"dose"},"Dose",-1)),p(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>o.newVaccination.dose=r),type:"text",class:"form-control",id:"dose",placeholder:"Entrez la dose",required:""},null,512),[[f,o.newVaccination.dose]])]),t("div",G,[e[8]||(e[8]=t("label",{for:"observation"},"Observation",-1)),p(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>o.newVaccination.observation=r),type:"text",class:"form-control",id:"observation",placeholder:"Entrez les observations",required:""},null,512),[[f,o.newVaccination.observation]])])]),t("div",H,[t("button",{class:"btn btn-primary",onClick:e[3]||(e[3]=r=>l.addVaccination({...o.newVaccination}))}," Ajouter "),e[9]||(e[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Fermer ",-1))])])])]),e[12]||(e[12]=t("p",null,"Aucune vaccination trouvée.",-1))])):(m(),v(h,{key:1,columns:o.vaccinationColumns,data:o.paginatedData,title:"Liste des Vaccinations",formFields:o.vaccinationFields,onAction:l.handleTableAction,onAddData:l.addVaccination,onEditData:l.editVaccination},null,8,["columns","data","formFields","onAction","onAddData","onEditData"])),x(b,{currentPage:o.currentPage,totalItems:o.totalItems,itemsPerPage:o.itemsPerPage,onPageChanged:l.handlePageChange},null,8,["currentPage","totalItems","itemsPerPage","onPageChanged"])])])])]),_:1})}const $=_(C,[["render",J]]);export{$ as default};
