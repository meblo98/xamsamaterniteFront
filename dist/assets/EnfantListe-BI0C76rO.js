import{L as b}from"./Layout-Ds3QvfcV.js";import{P as _}from"./pagination-B0tE2wTz.js";import{T as y}from"./tableau-nIdjVny8.js";import{a as P}from"./accouchementService-CuycJTc3.js";import{e as d}from"./enfantService-DQKxlz4_.js";import{S as o}from"./sweetalert2.all-BXtj_mcp.js";import{e as v,f as A,h as u,o as r,c,a as n,d as l,i as w,F as I,r as x,v as m,g as p,t as f}from"./index-C-f7vtLL.js";import{_ as L}from"./_plugin-vue_export-helper-Cm6_9V8g.js";const C="view",k="edit",D="delete",T={components:{Layout:b,Pagination:_,Table:y},data(){return{selectedAccouchementId:"",accouchements:[],newEnfant:{nom:"",prenom:"",date_naissance:"",lieu_naissance:"",accouchement_id:""},getFormData(){return{nom:this.newEnfant.nom,prenom:this.newEnfant.prenom,date_naissance:this.newEnfant.date_naissance,lieu_naissance:this.newEnfant.lieu_naissance,accouchement_id:this.selectedAccouchementId}},columns:[{label:"Nom",field:"nom"},{label:"Prénom",field:"prenom"},{label:"Date de Naissance",field:"date_naissance"},{label:"Lieu de Naissance",field:"lieu_naissance"},{label:"Actions",field:"action",type:"action"}],formFields:[{name:"prenom",label:"Prénom",type:"text",placeholder:"Entrez le prénom"},{name:"nom",label:"Nom",type:"text",placeholder:"Entrez le nom"},{name:"date_naissance",label:"Date de Naissance",type:"date",placeholder:"Entrez la date de naissance"},{name:"lieu_naissance",label:"Lieu de Naissance",type:"text",placeholder:"Entrez le lieu de naissance"},{name:"accouchement_id",label:"Mère de l'enfant",type:"select",options:[]}],allData:[],paginatedData:[],currentPage:1,totalItems:0,itemsPerPage:10}},mounted(){this.getEnfants(),this.getAccouchements()},methods:{updateAccouchementId(){this.newEnfant.accouchement_id=this.selectedAccouchementId},async getAccouchements(){try{const t=await P.getAccouchements();this.accouchements=t.accouchements,this.formFields[4].options=this.accouchements.map(e=>({value:e.id,text:`${e.patiente.user.prenom} ${e.patiente.user.nom} (${e.patiente.user.telephone})`}))}catch(t){console.error(t)}},async getEnfants(){try{const t=await d.getEnfants();t&&t.Liste_des_enfants&&Array.isArray(t.Liste_des_enfants)&&(this.allData=t.Liste_des_enfants.map(e=>({id:e.id,nom:e.nom,prenom:e.prenom,accouchement_id:e.accouchement_id,lieu_naissance:e.lieu_naissance,date_naissance:e.date_naissance})),this.totalItems=this.allData.length,this.getEnfantsPaginated())}catch(t){console.error("Erreur lors de la récupération des enfants :",t)}},handleTableAction({action:t,row:e}){switch(t){case C:this.$router.push({name:"detailEnfant-sage-femme",params:{id:e.id}});break;case k:this.editEnfant(e);break;case D:this.deleteEnfant(e.id);break}},async addEnfant(t){if(!t.nom||!t.prenom||!t.date_naissance||!t.lieu_naissance||!t.accouchement_id){o.fire({icon:"error",title:"Erreur",text:"Tous les champs sont requis."});return}try{await d.createEnfant(t),this.getEnfants(),o.fire({title:"Enfant ajouté avec succès !",icon:"success",showConfirmButton:!1,timer:1500}),this.$router.replace({name:"enfant-sage-femme"})}catch(e){console.error("Erreur lors de l'ajout de l'enfant :",e),o.fire({icon:"error",title:"Erreur",text:"Impossible d'ajouter l'enfant."})}},async editEnfant(t){if(!t.nom||!t.prenom||!t.date_naissance||!t.lieu_naissance){o.fire({icon:"error",title:"Erreur",text:"Tous les champs sont requis."});return}try{await d.updateEnfant(t.id,t),this.getEnfants(),o.fire({title:"Enfant modifié avec succès !",icon:"success",showConfirmButton:!1,timer:1500})}catch(e){console.error("Erreur lors de la modification de l'enfant :",e),o.fire({icon:"error",title:"Erreur",text:"Impossible de modifier l'enfant."})}},async deleteEnfant(t){try{await d.deleteEnfant(t),this.getEnfants(),o.fire({title:"Enfant supprimé avec succès !",icon:"success",showConfirmButton:!1,timer:1500})}catch(e){console.error("Erreur lors de la suppression de l'enfant :",e),o.fire({icon:"error",title:"Erreur",text:"Impossible de supprimer l'enfant."})}},getEnfantsPaginated(){const t=(this.currentPage-1)*this.itemsPerPage;this.paginatedData=this.allData.slice(t,t+this.itemsPerPage)},handlePageChange(t){this.currentPage=t,this.getEnfantsPaginated()}}},N={key:0},z={class:"modal fade",id:"ajoutEnfant","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},B={class:"modal-dialog"},F={class:"modal-content"},j={class:"modal-body"},S={class:"form-group"},V=["value"],q={class:"form-group"},U={class:"form-group"},M={class:"form-group"},O={class:"form-group"},W={class:"modal-footer"},G={key:1,class:"tableau"};function H(t,e,J,K,a,i){const E=u("Table"),h=u("Pagination"),g=u("Layout");return r(),v(g,null,{default:A(()=>[a.allData.length===0?(r(),c("div",N,[e[15]||(e[15]=n("button",{type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#ajoutEnfant"}," Ajouter un Enfant ",-1)),n("div",z,[n("div",B,[n("div",F,[e[14]||(e[14]=n("div",{class:"modal-header"},[n("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Ajouter un Enfant "),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),n("div",j,[n("div",S,[e[8]||(e[8]=n("label",{for:"accouchement"},"Sélectionnez un accouchement (par nom de la mère)",-1)),l(n("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>a.selectedAccouchementId=s),class:"form-control",id:"accouchement_id",onChange:e[1]||(e[1]=(...s)=>i.updateAccouchementId&&i.updateAccouchementId(...s))},[e[7]||(e[7]=n("option",{value:"",disabled:"",selected:""}," Sélectionnez La mère de l'enfant ",-1)),(r(!0),c(I,null,x(a.accouchements,s=>(r(),c("option",{key:s.id,value:s.id},f(s.patiente.user.prenom)+" "+f(s.patiente.user.nom)+" ("+f(s.patiente.user.telephone)+") ",9,V))),128))],544),[[w,a.selectedAccouchementId]])]),n("div",q,[e[9]||(e[9]=n("label",{for:"prenom"},"Prénom de l'Enfant",-1)),l(n("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>a.newEnfant.prenom=s),type:"text",class:"form-control",id:"prenom",placeholder:"Donnez le prénom",required:""},null,512),[[m,a.newEnfant.prenom]])]),n("div",U,[e[10]||(e[10]=n("label",{for:"nom"},"Nom de l'Enfant",-1)),l(n("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>a.newEnfant.nom=s),type:"text",class:"form-control",id:"nom",placeholder:"Donnez le nom",required:""},null,512),[[m,a.newEnfant.nom]])]),n("div",M,[e[11]||(e[11]=n("label",{for:"date_naissance"},"Date de naissance de l'Enfant",-1)),l(n("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>a.newEnfant.date_naissance=s),type:"date",class:"form-control",id:"date_naissance",placeholder:"Donnez la date de naissance",required:""},null,512),[[m,a.newEnfant.date_naissance]])]),n("div",O,[e[12]||(e[12]=n("label",{for:"lieu_naissance"},"Lieu de naissance de l'Enfant",-1)),l(n("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>a.newEnfant.lieu_naissance=s),type:"text",class:"form-control",id:"lieu_naissance",placeholder:"Donnez le lieu de naissance",required:""},null,512),[[m,a.newEnfant.lieu_naissance]])])]),n("div",W,[n("button",{class:"btn btn-primary",onClick:e[6]||(e[6]=s=>i.addEnfant({...a.newEnfant}))}," Ajouter "),e[13]||(e[13]=n("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Fermer ",-1))])])])]),e[16]||(e[16]=n("p",null,"Aucun Enfant trouvé.",-1))])):(r(),c("div",G,[p(E,{columns:a.columns,data:a.paginatedData,title:"Liste des Enfants",formFields:a.formFields,onAction:i.handleTableAction,onAddData:i.addEnfant,onEditData:i.editEnfant},null,8,["columns","data","formFields","onAction","onAddData","onEditData"]),p(h,{currentPage:a.currentPage,totalItems:a.totalItems,itemsPerPage:a.itemsPerPage,onPageChanged:i.handlePageChange},null,8,["currentPage","totalItems","itemsPerPage","onPageChanged"])]))]),_:1})}const ne=L(T,[["render",H]]);export{ne as default};
