import{L as v}from"./Layout-BJFKaUJJ.js";import{M as V,e as y,f as h,h as _,o as n,a as t,d as c,v as b,c as m,r as k,F as g,t as w}from"./index-1QRIi6KU.js";/* empty css                                                               */import{_ as x}from"./_plugin-vue_export-helper-rQ_DBal5.js";import{v as r}from"./visiteService-CC6qtgka.js";import{S as l}from"./sweetalert2.all-BmwYcicJ.js";const L={components:{Layout:v},data(){return{visites:[],newVisite:{libelle:""},editedVisite:{id:"",libelle:""}}},mounted(){this.getVisites()},methods:{async getVisites(){try{const i=await r.getVisites();this.visites=i.ListeVisites,console.log(this.visites)}catch(i){console.error("Erreur lors de la récupération des visites :",i)}},async addVisite(){try{await r.createVisite(this.newVisite),this.getVisites(),this.resetForm(),l.fire({title:"Visite ajoutée avec succès!",icon:"success"})}catch{l.fire({title:"Erreur lors de l'ajout de la visite",text:"Veuillez vérifier les informations et réessayer.",icon:"error"})}},resetForm(){this.newVisite={libelle:""}},async deleteVisite(i){l.fire({title:"Supprimer la visite?",text:"Voulez-vous vraiment supprimer cette visite?",icon:"warning",showCancelButton:!0,confirmButtonText:"Oui, supprimer",cancelButtonText:"Non, annuler"}).then(async e=>{if(e.isConfirmed)try{await r.deleteVisite(i),this.getVisites(),l.fire({title:"Visite supprimée avec succès!",icon:"success",showConfirmButton:!1,timer:1500})}catch(d){console.error("Erreur lors de la suppression de la visite :",d),l.fire({title:"Erreur lors de la suppression",text:"Veuillez réessayer.",icon:"error"})}})},async editVisite(i){const e=this.visites.find(u=>u.id===i);this.editedVisite={...e},new V(this.$refs.editVisite).show()},async updateVisite(){try{await r.updateVisite(this.editedVisite.id,this.editedVisite),this.getVisites(),l.fire({title:"Visite mise à jour avec succès!",icon:"success"})}catch{l.fire({title:"Erreur lors de la mise à jour de la visite",text:"Veuillez réessayer.",icon:"error"})}}}},C={class:"visite-list"},B={class:"header"},j={class:"actions"},A={class:"modal fade",id:"ajoutVisite","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},E={class:"modal-dialog"},M={class:"modal-content"},z={class:"modal-body"},S={class:"form-group"},F={class:"modal-footer"},N={class:"table-responsive"},T={class:"table m-3"},D=["onClick"],U=["onClick"],I={class:"modal fade",id:"editVisite",ref:"editVisite","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},O={class:"modal-dialog"},q={class:"modal-content"},G={class:"modal-body"},H={class:"form-group"},J={class:"modal-footer"};function K(i,e,d,u,a,o){const p=_("Layout");return n(),y(p,null,{default:h(()=>[t("div",C,[t("div",B,[e[8]||(e[8]=t("h1",null,"Liste des Visites",-1)),t("div",j,[e[7]||(e[7]=t("button",{type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#ajoutVisite"}," Ajouter une visite ",-1)),t("div",A,[t("div",E,[t("div",M,[e[6]||(e[6]=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Ajouter une visite "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",z,[t("div",S,[e[4]||(e[4]=t("label",{for:"libelle"},"Libelle",-1)),c(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>a.newVisite.libelle=s),type:"text",class:"form-control",id:"libelle",placeholder:"Entrez le libelle"},null,512),[[b,a.newVisite.libelle]])])]),t("div",F,[t("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=(...s)=>o.addVisite&&o.addVisite(...s))}," Ajouter "),e[5]||(e[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Annuler ",-1))])])])])])]),t("div",N,[t("table",T,[e[11]||(e[11]=t("thead",null,[t("tr",null,[t("th",null,"Nom de la visite"),t("th",null,"Actions")])],-1)),t("tbody",null,[(n(!0),m(g,null,k(a.visites,s=>(n(),m("tr",{key:s.id},[t("td",null,w(s.libelle),1),t("td",null,[t("button",{class:"btn-action",onClick:f=>o.editVisite(s.id)},e[9]||(e[9]=[t("i",{class:"fa fa-edit"},null,-1)]),8,D),t("button",{class:"btn-action",onClick:f=>o.deleteVisite(s.id)},e[10]||(e[10]=[t("i",{class:"fa-solid fa-trash-can"},null,-1)]),8,U)])]))),128))])])])]),t("div",I,[t("div",O,[t("div",q,[e[14]||(e[14]=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Modifier une visite "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",G,[t("form",null,[t("div",H,[e[12]||(e[12]=t("label",{for:"libelle"},"Libelle",-1)),c(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>a.editedVisite.libelle=s),type:"text",class:"form-control",id:"libelle"},null,512),[[b,a.editedVisite.libelle]])])])]),t("div",J,[t("button",{class:"btn btn-primary",onClick:e[3]||(e[3]=(...s)=>o.updateVisite&&o.updateVisite(...s))}," Modifier "),e[13]||(e[13]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Annuler ",-1))])])])],512)]),_:1})}const Z=x(L,[["render",K],["__scopeId","data-v-1889a522"]]);export{Z as default};
